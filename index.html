<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prizma - Türkçe Bilgi Yarışması</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="questions.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .animate-bounce {
            animation: bounce 1s infinite;
        }
        
        .animate-ping {
            animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(-25%);
                animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
            }
            50% {
                transform: translateY(0);
                animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
            }
        }
        
        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        
        .hover\:scale-105:hover {
            transform: scale(1.05);
        }
        
        .hover\:scale-102:hover {
            transform: scale(1.02);
        }
        
        .hover\:scale-110:hover {
            transform: scale(1.1);
        }
        
        .scale-105 {
            transform: scale(1.05);
        }
        
        .scale-102 {
            transform: scale(1.02);
        }
        
        .backdrop-blur-lg {
            backdrop-filter: blur(16px);
        }
        
        .bg-clip-text {
            -webkit-background-clip: text;
            background-clip: text;
        }
        
        .text-transparent {
            color: transparent;
        }

        /* Mobil uyumluluk için ek stiller */
        @media (max-width: 768px) {
            .mobile-title {
                font-size: 2rem !important;
                line-height: 1.2 !important;
            }
            
            .mobile-subtitle {
                font-size: 1.1rem !important;
            }
            
            .mobile-grid {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.75rem !important;
            }
            
            .mobile-button {
                padding: 0.75rem !important;
                font-size: 0.875rem !important;
            }
            
            .mobile-text {
                font-size: 1rem !important;
            }
            
            .mobile-padding {
                padding: 1rem !important;
            }
            
            .mobile-margin {
                margin: 0.5rem !important;
            }
        }

        @media (max-width: 480px) {
            .mobile-title {
                font-size: 1.5rem !important;
            }
            
            .mobile-grid {
                grid-template-columns: 1fr !important;
            }
            
            .mobile-flex {
                flex-direction: column !important;
            }
        }

        /* PRİZMA yazısı için özel animasyon */
        .prizma-text {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57, #ff9ff3, #54a0ff);
            background-size: 400% 400%;
            animation: gradientShift 3s ease infinite;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        .prizma-glow {
            filter: drop-shadow(0 0 20px rgba(255, 107, 107, 0.6));
        }

        /* Ses efektleri için */
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .sound-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        /* Başarı animasyonları */
        .correct-answer {
            animation: correctPulse 0.6s ease-in-out;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); background: linear-gradient(45deg, #4ade80, #22c55e); }
            100% { transform: scale(1); }
        }

        .incorrect-answer {
            animation: incorrectShake 0.6s ease-in-out;
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Skor animasyonu */
        .score-animation {
            animation: scoreBounce 0.8s ease-in-out;
        }

        @keyframes scoreBounce {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Konfeti animasyonu */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57, #ff9ff3, #54a0ff);
            animation: confettiFall 3s linear forwards;
        }

                 @keyframes confettiFall {
             0% {
                 transform: translateY(-100vh) rotate(0deg);
                 opacity: 1;
             }
             100% {
                 transform: translateY(100vh) rotate(720deg);
                 opacity: 0;
             }
         }

         /* Timer Stilleri */
         .timer-container {
             position: relative;
             width: 80px;
             height: 80px;
         }

         .timer-circle {
             width: 100%;
             height: 100%;
             border-radius: 50%;
             background: conic-gradient(from 0deg, #ef4444, #f97316, #eab308, #22c55e);
             display: flex;
             align-items: center;
             justify-content: center;
             position: relative;
             transition: all 0.3s ease;
         }

         .timer-circle::before {
             content: '';
             position: absolute;
             width: 70%;
             height: 70%;
             background: rgba(0, 0, 0, 0.8);
             border-radius: 50%;
             backdrop-filter: blur(10px);
         }

         .timer-text {
             position: relative;
             z-index: 1;
             font-weight: bold;
             color: white;
             font-size: 1.2rem;
         }

         .timer-warning {
             animation: timerPulse 1s infinite;
         }

         @keyframes timerPulse {
             0%, 100% { transform: scale(1); }
             50% { transform: scale(1.1); }
         }

         .timer-critical {
             animation: timerShake 0.5s infinite;
             background: conic-gradient(from 0deg, #dc2626, #b91c1c) !important;
         }

         @keyframes timerShake {
             0%, 100% { transform: translateX(0); }
             25% { transform: translateX(-2px); }
             75% { transform: translateX(2px); }
         }

         /* Başarı Popup Stilleri */
         .achievement-popup {
             position: fixed;
             top: 50%;
             left: 50%;
             transform: translate(-50%, -50%);
             z-index: 2000;
             background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
             border: 3px solid #ffd700;
             border-radius: 20px;
             padding: 2rem;
             text-align: center;
             box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
             animation: achievementSlideIn 0.5s ease-out;
         }

         @keyframes achievementSlideIn {
             0% {
                 transform: translate(-50%, -50%) scale(0.5);
                 opacity: 0;
             }
             100% {
                 transform: translate(-50%, -50%) scale(1);
                 opacity: 1;
             }
         }

         .achievement-emoji {
             font-size: 4rem;
             margin-bottom: 1rem;
             animation: achievementBounce 2s infinite;
         }

         @keyframes achievementBounce {
             0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
             40% { transform: translateY(-10px); }
             60% { transform: translateY(-5px); }
         }

         .achievement-title {
             font-size: 1.5rem;
             font-weight: bold;
             color: #ffd700;
             margin-bottom: 0.5rem;
         }

         .achievement-description {
             color: white;
             font-size: 1rem;
         }




    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const TRANSLATIONS = {
          "tr-TR": {
            "triviaTitle": "PRİZMA",
            "triviaSubtitle": "Bilginizi Test Edin",
            "rulesTitle": "📋 Kurallar ve Bilgiler",
            "rulesContent": {
              "howToPlay": "🎮 Nasıl Oynanır?",
              "howToPlayDesc": "İstediğiniz kategorileri seçin, zorluk seviyenizi belirleyin ve soru sayısını ayarlayın. Her soruya 4 seçenekten birini seçerek cevap verin.",
              "questionBank": "🎯 Soru Bankası",
              "questionBankDesc": "Sonsuz soru çeşitliliği! Her oyunda Claude AI tarafından gerçek zamanlı olarak yeni sorular üretilir. Aynı soruyu iki kez görmezsiniz.",
              "scoring": "⭐ Puanlama",
              "scoringDesc": "Her doğru cevap 1 puan değerindedir. Oyun sonunda başarı yüzdenizi ve detaylı analizinizi görebilirsiniz.",
              "categories": "🎨 Kategoriler",
              "categoriesDesc": "16 farklı kategori: Türkiye Tarihi, Dünya Tarihi, Coğrafya, Spor, Sinema, Müzik, Edebiyat, Sanat, Teknoloji, Yemek Kültürü, Hayvanlar, Uzay, Türk Dili, Matematik, Fen Bilgisi, Türk Musikisi",
              "difficulty": "⚡ Zorluk Seviyeleri",
              "difficultyDesc": "Kolay: Temel bilgiler, Orta: Genel kültür, Zor: Uzman seviyesi sorular"
            },
            "categoriesTitle": "Kategoriler",
            "difficultyTitle": "Zorluk Seviyesi",
            "numQuestionsTitle": "Soru Sayısı",
            "startGameButton": "Oyunu Başlat",
            "generatingQuestionsTitle": "Sorular hazırlanıyor...",
            "generatingQuestionsSubtitle": "Bilgi yarışmanız için sorular oluşturuluyor",
            "questionOf": "Soru",
            "of": "/",
            "score": "Puan:",
            "checkAnswerButton": "Cevabı Kontrol Et",
            "nextQuestionButton": "Sonraki Soru",
            "finishGameButton": "Oyunu Bitir",
            "resultsTitle": "Sonuçlar",
            "correct": "Doğru",
            "excellentMessage": "🏆 Mükemmel!",
            "goodJobMessage": "👍 Harika iş!",
            "notBadMessage": "👌 Fena değil!",
            "keepStudyingMessage": "📚 Daha çok çalış!",
            "yourAnswer": "Cevabınız:",
            "correctAnswer": "Doğru cevap:",
            "playAgainButton": "Tekrar Oyna",
            "selectCategoryAlert": "Lütfen en az bir kategori seçin!",
            "selectAnswerAlert": "Lütfen bir cevap seçin!",
            "generateQuestionsError": "Sorular oluşturulamadı. Lütfen tekrar deneyin.",
            "easy": "Kolay",
            "medium": "Orta",
            "hard": "Zor"
          }
        };

        const appLocale = 'tr-TR';
        const locale = 'tr-TR';
        const t = (key) => TRANSLATIONS[locale]?.[key] || key;

        const TriviaGame = () => {
          const [gameState, setGameState] = useState('setup');
          const [categories, setCategories] = useState([]);
          const [difficulty, setDifficulty] = useState('medium');
          const [numQuestions, setNumQuestions] = useState(5);
          const [questions, setQuestions] = useState([]);
          const [currentQuestion, setCurrentQuestion] = useState(0);
          const [selectedAnswer, setSelectedAnswer] = useState(null);
          const [score, setScore] = useState(0);
          const [answers, setAnswers] = useState([]);
          const [showAnswer, setShowAnswer] = useState(false);
          const [soundEnabled, setSoundEnabled] = useState(true);
          const [showConfetti, setShowConfetti] = useState(false);
          const [timeLeft, setTimeLeft] = useState(0);
          const [timerId, setTimerId] = useState(null);
          const [timerEnabled, setTimerEnabled] = useState(true);
          const [highScores, setHighScores] = useState([]);
          const [totalGamesPlayed, setTotalGamesPlayed] = useState(0);
          const [achievements, setAchievements] = useState([]);
          const [showAchievement, setShowAchievement] = useState(null);
          const [theme, setTheme] = useState('default');
          const [highContrast, setHighContrast] = useState(false);
          const [showLeaderboard, setShowLeaderboard] = useState(false);
          const [globalScores, setGlobalScores] = useState([]);
          const [nickname, setNickname] = useState('');
          const [loadingScores, setLoadingScores] = useState(false);
          
          // AudioContext'i tek seferde oluştur (memory leak'i önlemek için)
          const [audioContext] = useState(() => {
            try {
              return new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
              console.warn('AudioContext not supported');
              return null;
            }
          });

          // Local Storage fonksiyonları
          const saveToLocalStorage = (key, value) => {
            try {
              localStorage.setItem(`prizma_${key}`, JSON.stringify(value));
            } catch (error) {
              console.warn('Local storage kaydedilemedi:', error);
            }
          };

          const loadFromLocalStorage = (key, defaultValue) => {
            try {
              const saved = localStorage.getItem(`prizma_${key}`);
              return saved ? JSON.parse(saved) : defaultValue;
            } catch (error) {
              console.warn('Local storage okunamadı:', error);
              return defaultValue;
            }
          };

          // Tema tanımları
          const themes = {
            default: {
              name: 'Varsayılan',
              emoji: '🌈',
              background: 'from-indigo-900 via-purple-900 to-pink-900',
              primary: 'from-blue-400 to-indigo-500',
              secondary: 'from-purple-400 to-pink-500',
              accent: 'from-green-400 to-blue-500'
            },
            dark: {
              name: 'Gece Modu',
              emoji: '🌙',
              background: 'from-gray-900 via-black to-gray-900',
              primary: 'from-gray-600 to-gray-700',
              secondary: 'from-gray-700 to-gray-800',
              accent: 'from-indigo-500 to-purple-600'
            },
            colorblind: {
              name: 'Renk Körleri',
              emoji: '👁️',
              background: 'from-blue-900 via-teal-900 to-cyan-900',
              primary: 'from-blue-400 to-cyan-500',
              secondary: 'from-teal-400 to-blue-500',
              accent: 'from-cyan-400 to-teal-500'
            },
            ocean: {
              name: 'Okyanus',
              emoji: '🌊',
              background: 'from-blue-900 via-teal-800 to-cyan-900',
              primary: 'from-blue-400 to-teal-500',
              secondary: 'from-teal-400 to-cyan-500',
              accent: 'from-cyan-400 to-blue-500'
            }
          };

          // Başarı tanımları
          const achievementDefinitions = [
            { id: 'first_game', name: 'İlk Adım', description: 'İlk oyununu tamamla', emoji: '🎯', requirement: (stats) => stats.gamesPlayed >= 1 },
            { id: 'perfect_score', name: 'Mükemmel!', description: 'Tüm soruları doğru cevapla', emoji: '💯', requirement: (stats) => stats.perfectGames >= 1 },
            { id: 'speed_demon', name: 'Hız Canavarı', description: '10 saniyede soru cevapla', emoji: '⚡', requirement: (stats) => stats.fastAnswers >= 5 },
            { id: 'streak_master', name: 'Seri Ustası', description: 'Üst üste 10 doğru cevap', emoji: '🔥', requirement: (stats) => stats.bestStreak >= 10 },
            { id: 'category_master', name: 'Kategori Uzmanı', description: 'Bir kategoride %90+ al', emoji: '🎓', requirement: (stats) => stats.categoryMastery >= 1 },
            { id: 'veteran', name: 'Veteran', description: '50 oyun tamamla', emoji: '🏆', requirement: (stats) => stats.gamesPlayed >= 50 },
            { id: 'knowledge_seeker', name: 'Bilgi Avcısı', description: 'Tüm kategorileri dene', emoji: '📚', requirement: (stats) => stats.categoriesTried >= 16 },
            { id: 'time_master', name: 'Zaman Ustası', description: 'Timer açıkken 10 oyun kazan', emoji: '⏰', requirement: (stats) => stats.timerWins >= 10 }
          ];

          // Component mount edildiğinde tercihleri yükle
          React.useEffect(() => {
            setSoundEnabled(loadFromLocalStorage('soundEnabled', true));
            setCategories(loadFromLocalStorage('lastCategories', []));
            setDifficulty(loadFromLocalStorage('lastDifficulty', 'medium'));
            setNumQuestions(loadFromLocalStorage('lastNumQuestions', 5));
            setTimerEnabled(loadFromLocalStorage('timerEnabled', true));
            setHighScores(loadFromLocalStorage('highScores', []));
            setTotalGamesPlayed(loadFromLocalStorage('totalGamesPlayed', 0));
            setAchievements(loadFromLocalStorage('achievements', []));
            setTheme(loadFromLocalStorage('theme', 'default'));
            setHighContrast(loadFromLocalStorage('highContrast', false));
            setNickname(loadFromLocalStorage('nickname', ''));
          }, []);


          const availableCategories = [
            { name: 'Türkiye Tarihi', emoji: '🏛️', color: 'from-amber-400 to-orange-500' },
            { name: 'Dünya Tarihi', emoji: '🌍', color: 'from-blue-400 to-indigo-500' },
            { name: 'Coğrafya', emoji: '🗺️', color: 'from-emerald-400 to-teal-500' },
            { name: 'Spor', emoji: '⚽', color: 'from-green-400 to-lime-500' },
            { name: 'Sinema', emoji: '🎬', color: 'from-purple-400 to-pink-500' },
            { name: 'Müzik', emoji: '🎵', color: 'from-rose-400 to-red-500' },
            { name: 'Edebiyat', emoji: '📚', color: 'from-indigo-400 to-purple-500' },
            { name: 'Sanat', emoji: '🎨', color: 'from-pink-400 to-rose-500' },
            { name: 'Teknoloji', emoji: '💻', color: 'from-cyan-400 to-blue-500' },
            { name: 'Yemek Kültürü', emoji: '🍽️', color: 'from-orange-400 to-red-500' },
            { name: 'Hayvanlar', emoji: '🦁', color: 'from-yellow-400 to-orange-500' },
            { name: 'Uzay', emoji: '🚀', color: 'from-violet-400 to-purple-500' },
            { name: 'Türk Dili', emoji: '📖', color: 'from-red-400 to-pink-500' },
            { name: 'Matematik', emoji: '🔢', color: 'from-teal-400 to-cyan-500' },
            { name: 'Fen Bilgisi', emoji: '🧪', color: 'from-lime-400 to-green-500' },
            { name: 'Türk Musikisi', emoji: '🎶', color: 'from-amber-400 to-yellow-500' }
          ];

          const toggleCategory = (categoryName) => {
            setCategories(prev => {
              const newCategories = prev.includes(categoryName) 
                ? prev.filter(c => c !== categoryName)
                : [...prev, categoryName];
              saveToLocalStorage('lastCategories', newCategories);
              return newCategories;
            });
          };

          // Ses efektleri (optimize edilmiş - memory leak yok)
          const playSound = async (type) => {
            if (!soundEnabled || !audioContext) return;
            
            try {
              // iOS Safari için AudioContext'i resume et
              if (audioContext.state === 'suspended') {
                await audioContext.resume();
              }
              
              const oscillator = audioContext.createOscillator();
              const gainNode = audioContext.createGain();
              
              oscillator.connect(gainNode);
              gainNode.connect(audioContext.destination);
              
              switch(type) {
                case 'correct':
                  oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                  oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.15);
                  gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                  oscillator.start(audioContext.currentTime);
                  oscillator.stop(audioContext.currentTime + 0.15);
                  break;
                case 'incorrect':
                  oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                  oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.25);
                  gainNode.gain.setValueAtTime(0.25, audioContext.currentTime);
                  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.25);
                  oscillator.start(audioContext.currentTime);
                  oscillator.stop(audioContext.currentTime + 0.25);
                  break;
                case 'click':
                  oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
                  oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.05);
                  gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.05);
                  oscillator.start(audioContext.currentTime);
                  oscillator.stop(audioContext.currentTime + 0.05);
                  break;
              }
            } catch (error) {
              console.warn('Ses çalınırken hata:', error);
            }
          };

          // Konfeti efekti
          const createConfetti = () => {
            setShowConfetti(true);
            setTimeout(() => setShowConfetti(false), 3000);
          };

          // Animasyon sınıfları
          const getAnswerClass = (index, isCorrect, isSelected) => {
            if (!showAnswer) return '';
            if (index === questions[currentQuestion].correctAnswer) return 'correct-answer';
            if (index === selectedAnswer && !isCorrect) return 'incorrect-answer';
            return '';
          };

          // Timer fonksiyonları
          const getTimeLimit = (difficulty) => {
            const timeMap = { easy: 30, medium: 20, hard: 15 };
            return timeMap[difficulty] || 20;
          };

          const startTimer = () => {
            if (!timerEnabled) return;
            
            const timeLimit = getTimeLimit(difficulty);
            setTimeLeft(timeLimit);
            
            const id = setInterval(() => {
              setTimeLeft(prev => {
                if (prev <= 1) {
                  clearInterval(id);
                  handleTimeUp();
                  return 0;
                }
                return prev - 1;
              });
            }, 1000);
            
            setTimerId(id);
          };

          const stopTimer = () => {
            if (timerId) {
              clearInterval(timerId);
              setTimerId(null);
            }
          };

          const handleTimeUp = () => {
            if (!showAnswer) {
              setSelectedAnswer(-1); // Zaman doldu işareti
              setShowAnswer(true);
              playSound('incorrect');
            }
          };

          // Başarı kontrolü
          const checkAchievements = (gameStats) => {
            const newAchievements = [];
            
            achievementDefinitions.forEach(def => {
              if (!achievements.includes(def.id) && def.requirement(gameStats)) {
                newAchievements.push(def.id);
                showAchievementPopup(def);
              }
            });
            
            if (newAchievements.length > 0) {
              const updatedAchievements = [...achievements, ...newAchievements];
              setAchievements(updatedAchievements);
              saveToLocalStorage('achievements', updatedAchievements);
            }
          };

          // Başarı popup'ı göster
          const showAchievementPopup = (achievement) => {
            setShowAchievement(achievement);
            setTimeout(() => {
              setShowAchievement(null);
            }, 4000);
          };

          // Tema değiştirme
          const changeTheme = (newTheme) => {
            setTheme(newTheme);
            saveToLocalStorage('theme', newTheme);
          };

          const toggleHighContrast = () => {
            const newValue = !highContrast;
            setHighContrast(newValue);
            saveToLocalStorage('highContrast', newValue);
          };

          // Aktif tema almak
          const currentTheme = themes[theme] || themes.default;

          // Firebase Configuration
          const firebaseConfig = {
            apiKey: "AIzaSyCkQSN7S8r8UZJ504eTxT23Qe_S1E52LIw",
            authDomain: "prizma-quiz-game.firebaseapp.com",
            databaseURL: "https://prizma-quiz-game-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "prizma-quiz-game",
            storageBucket: "prizma-quiz-game.firebasestorage.app",
            messagingSenderId: "1030273127688",
            appId: "1:1030273127688:web:cf88e1c1d1eb88e2b488bd"
          };

          // Initialize Firebase
          let firebaseApp, database;
          try {
            firebaseApp = firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            console.log('🔥 Firebase başarıyla bağlandı!');
          } catch (error) {
            console.warn('⚠️ Firebase bağlantı hatası, mock sisteme geçiliyor:', error);
            database = null;
          }

          // Global leaderboard fonksiyonları (Firebase + Fallback Mock)
          const fetchGlobalScores = async () => {
            setLoadingScores(true);
            try {
              if (database) {
                // Firebase'den skorları al
                const scoresRef = database.ref('leaderboard');
                // Tüm skorları çek ve istemci tarafında sırala
                const snapshot = await scoresRef.once('value');
                const scores = [];
                
                snapshot.forEach((childSnapshot) => {
                  scores.push({
                    id: childSnapshot.key,
                    ...childSnapshot.val()
                  });
                });
                
                // Yüksek skordan düşüğe sırala
                scores.sort((a, b) => {
                  if (a.percentage === b.percentage) {
                    return b.timestamp - a.timestamp;
                  }
                  return b.percentage - a.percentage;
                });
                
                setGlobalScores(scores);
                console.log('🔥 Firebase\'den', scores.length, 'skor yüklendi');
              } else {
                // Fallback: localStorage'dan al
                const mockScores = loadFromLocalStorage('globalScores', []);
                setGlobalScores(mockScores);
                console.log('📱 Local storage\'dan', mockScores.length, 'skor yüklendi');
              }
            } catch (error) {
              console.warn('Global skorlar yüklenemedi:', error);
              // Fallback: localStorage'dan al
              const mockScores = loadFromLocalStorage('globalScores', []);
              setGlobalScores(mockScores);
            } finally {
              setLoadingScores(false);
            }
          };

          const submitScore = async (scoreData) => {
            if (!nickname.trim()) {
              alert('Lütfen bir nickname girin!');
              return;
            }

            try {
              const percentage = Math.round((scoreData.score / scoreData.totalQuestions) * 100);
              
              const newScore = {
                nickname: nickname.trim(),
                score: scoreData.score,
                totalQuestions: scoreData.totalQuestions,
                percentage: percentage,
                difficulty: scoreData.difficulty,
                categories: scoreData.categories?.slice(0, 3) || [],
                date: new Date().toLocaleDateString('tr-TR'),
                timestamp: Date.now()
              };

              if (database) {
                try {
                  // Firebase'e kaydet
                  const scoresRef = database.ref('leaderboard');
                  
                  // Aynı nickname ile mevcut skorları kontrol et
                  const existingQuery = await scoresRef.orderByChild('nickname').equalTo(nickname.trim()).once('value');
                  
                  let shouldSave = true;
                  let message = 'Skor kaydedildi!';
                  let existingKey = null;
                  
                  existingQuery.forEach((snapshot) => {
                    const existingScore = snapshot.val();
                    if (existingScore.percentage >= percentage) {
                      shouldSave = false;
                      message = 'Mevcut skorunuz daha yüksek!';
                    } else {
                      existingKey = snapshot.key;
                      message = 'Skor güncellendi!';
                    }
                  });
                  
                  if (shouldSave) {
                    if (existingKey) {
                      // Mevcut skoru güncelle
                      await scoresRef.child(existingKey).set(newScore);
                    } else {
                      // Yeni skor ekle
                      await scoresRef.push(newScore);
                    }
                    
                    // Sıralamayı hesapla
                    const rankSnapshot = await scoresRef.orderByChild('percentage').startAt(percentage).once('value');
                    let rank = 1;
                    rankSnapshot.forEach(() => rank++);
                    
                    alert(`🔥 ${message}\nSıralama: #${rank}`);
                    fetchGlobalScores();
                    console.log('🔥 Skor Firebase\'e kaydedildi');
                  } else {
                    alert(message);
                  }
                } catch (firebaseError) {
                  console.warn('Firebase yazma hatası, localStorage fallback:\n', firebaseError);
                  // Firebase hata verirse local fallback'e düş
                  const currentScores = loadFromLocalStorage('globalScores', []);
                  const existingIndex = currentScores.findIndex(s => s.nickname === nickname.trim());
                  if (existingIndex >= 0) {
                    if (currentScores[existingIndex].percentage < percentage) {
                      currentScores[existingIndex] = newScore;
                    }
                  } else {
                    currentScores.push(newScore);
                  }
                  currentScores.sort((a, b) => a.percentage === b.percentage ? (b.timestamp - a.timestamp) : (b.percentage - a.percentage));
                  const limitedScores = currentScores.slice(0, 50);
                  saveToLocalStorage('globalScores', limitedScores);
                  const rank = limitedScores.findIndex(s => s.nickname === nickname.trim()) + 1;
                  alert(`📱 Skor kaydedildi (offline).\nSıralama: #${rank}`);
                  fetchGlobalScores();
                }
              } else {
                // Fallback: localStorage kullan (eski sistem)
                const currentScores = loadFromLocalStorage('globalScores', []);
                const existingIndex = currentScores.findIndex(s => s.nickname === nickname.trim());
                
                let shouldUpdate = true;
                let message = 'Skor kaydedildi!';
                
                if (existingIndex >= 0) {
                  if (currentScores[existingIndex].percentage >= percentage) {
                    shouldUpdate = false;
                    message = 'Mevcut skorunuz daha yüksek!';
                  } else {
                    currentScores[existingIndex] = newScore;
                    message = 'Skor güncellendi!';
                  }
                } else {
                  currentScores.push(newScore);
                }

                if (shouldUpdate) {
                  currentScores.sort((a, b) => {
                    if (a.percentage === b.percentage) {
                      return b.timestamp - a.timestamp;
                    }
                    return b.percentage - a.percentage;
                  });
                  
                  const limitedScores = currentScores.slice(0, 50);
                  saveToLocalStorage('globalScores', limitedScores);
                  
                  const rank = limitedScores.findIndex(s => s.nickname === nickname.trim()) + 1;
                  alert(`📱 ${message}\nSıralama: #${rank}`);
                  fetchGlobalScores();
                } else {
                  alert(message);
                }
              }
              
            } catch (error) {
              console.warn('Skor gönderilemedi:', error);
              alert('Skor kaydedilemedi!');
            }
          };



          // Skoru paylaş (Web Share API + Twitter fallback)
          const shareScore = () => {
            try {
              const finalScore = score;
              const total = questions.length;
              const percentage = Math.round((finalScore / total) * 100);
              const text = `PRIZMA'da ${total} soruda ${finalScore} doğru ile %${percentage} yaptım! #prizmagame`;
              const url = 'https://sercansolmaz.github.io/prizma/';
              if (navigator.share) {
                navigator.share({ title: 'PRIZMA Skorum', text, url }).catch(() => {});
              } else {
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
                window.open(twitterUrl, '_blank');
              }
            } catch (e) {
              console.warn('Paylaşım başarısız:', e);
            }
          };


          const generateQuestions = async () => {
            if (categories.length === 0) {
              alert(t('selectCategoryAlert'));
              return;
            }

            playSound('click');
            setGameState('loading');
            
            // Gerçek soru veritabanından sorular seç
            setTimeout(() => {
              let availableQuestions = [];
              
              // Seçilen kategorilerden sorular topla
              categories.forEach(category => {
                if (QUESTION_DATABASE[category]) {
                  const categoryQuestions = QUESTION_DATABASE[category][difficulty] || [];
                  categoryQuestions.forEach(q => {
                    availableQuestions.push({
                      ...q,
                      category: category
                    });
                  });
                }
              });
              
              // Rastgele sorular seç
              const shuffled = availableQuestions.sort(() => Math.random() - 0.5);
              const selectedQuestions = shuffled.slice(0, numQuestions);
              setQuestions(selectedQuestions);
              setGameState('playing');
              setCurrentQuestion(0);
              setScore(0);
              setAnswers([]);
              
              // Timer'ı başlat
              setTimeout(() => {
                startTimer();
              }, 500);
            }, 2000);
          };

          const selectAnswer = (answerIndex) => {
            setSelectedAnswer(answerIndex);
            playSound('click');
          };

          const nextQuestion = () => {
            if (selectedAnswer === null && selectedAnswer !== -1) {
              alert(t('selectAnswerAlert'));
              return;
            }

            if (!showAnswer) {
              stopTimer();
              setShowAnswer(true);
              const isCorrect = selectedAnswer === questions[currentQuestion].correctAnswer;
              if (isCorrect) {
                playSound('correct');
              } else {
                playSound('incorrect');
              }
              return;
            }

            const isCorrect = selectedAnswer === questions[currentQuestion].correctAnswer;
            const newAnswers = [...answers, {
              questionIndex: currentQuestion,
              selectedAnswer,
              isCorrect,
              timeLeft: timeLeft
            }];
            
            setAnswers(newAnswers);
            
            if (isCorrect) {
              setScore(prevScore => {
                const newScore = prevScore + 1;
                // Yüksek skor için konfeti
                if (newScore >= questions.length * 0.8) {
                  createConfetti();
                }
                return newScore;
              });
            }
            
            if (currentQuestion + 1 < questions.length) {
              setCurrentQuestion(currentQuestion + 1);
              setSelectedAnswer(null);
              setShowAnswer(false);
              // Sonraki soru için timer'ı başlat
              setTimeout(() => {
                startTimer();
              }, 500);
            } else {
              stopTimer();
              setGameState('results');
              
              // İstatistikleri güncelle
              const finalScore = score + (isCorrect ? 1 : 0);
              const percentage = Math.round((finalScore / questions.length) * 100);
              const newGamesPlayed = totalGamesPlayed + 1;
              
              setTotalGamesPlayed(newGamesPlayed);
              saveToLocalStorage('totalGamesPlayed', newGamesPlayed);
              
              // Yüksek skor kontrolü
              const gameResult = {
                score: finalScore,
                total: questions.length,
                percentage,
                difficulty,
                categories: categories.slice(),
                date: new Date().toISOString(),
                timeEnabled: timerEnabled
              };
              
              const newHighScores = [...highScores, gameResult]
                .sort((a, b) => b.percentage - a.percentage)
                .slice(0, 10); // En iyi 10 skoru sakla
              
              setHighScores(newHighScores);
              saveToLocalStorage('highScores', newHighScores);
              
              // Başarı kontrolü için istatistikler hazırla
              const gameStats = {
                gamesPlayed: newGamesPlayed,
                perfectGames: finalScore === questions.length ? (loadFromLocalStorage('perfectGames', 0) + 1) : loadFromLocalStorage('perfectGames', 0),
                fastAnswers: loadFromLocalStorage('fastAnswers', 0) + answers.filter(a => a.timeLeft > getTimeLimit(difficulty) - 10).length,
                bestStreak: Math.max(loadFromLocalStorage('bestStreak', 0), Math.max(...answers.map((_, i) => {
                  let streak = 0;
                  for (let j = i; j < answers.length && answers[j].isCorrect; j++) {
                    streak++;
                  }
                  return streak;
                }))),
                categoryMastery: loadFromLocalStorage('categoryMastery', 0) + (percentage >= 90 ? 1 : 0),
                categoriesTried: new Set([...loadFromLocalStorage('categoriesTried', []), ...categories]).size,
                timerWins: timerEnabled && percentage >= 70 ? (loadFromLocalStorage('timerWins', 0) + 1) : loadFromLocalStorage('timerWins', 0)
              };
              
              // İstatistikleri kaydet
              saveToLocalStorage('perfectGames', gameStats.perfectGames);
              saveToLocalStorage('fastAnswers', gameStats.fastAnswers);
              saveToLocalStorage('bestStreak', gameStats.bestStreak);
              saveToLocalStorage('categoryMastery', gameStats.categoryMastery);
              saveToLocalStorage('categoriesTried', Array.from(new Set([...loadFromLocalStorage('categoriesTried', []), ...categories])));
              saveToLocalStorage('timerWins', gameStats.timerWins);
              
              // Başarıları kontrol et
              checkAchievements(gameStats);
              
              // Oyun sonu konfeti
              if (finalScore >= questions.length * 0.8) {
                createConfetti();
              }
            }
          };

          const resetGame = () => {
            stopTimer();
            setGameState('setup');
            setCurrentQuestion(0);
            setSelectedAnswer(null);
            setScore(0);
            setAnswers([]);
            setQuestions([]);
            setShowAnswer(false);
            setTimeLeft(0);
          };

          if (gameState === 'setup') {
            return (
              <div className={`min-h-screen bg-gradient-to-br ${currentTheme.background} text-white p-4 ${highContrast ? 'contrast-125 brightness-110' : ''}`}>
                <div className="max-w-4xl mx-auto">
                  <div className="text-center mt-4 md:mt-8 mb-8 md:mb-12">
                    <div className="relative">
                      <h1 className="mobile-title text-3xl md:text-5xl lg:text-7xl font-black mb-4 prizma-text prizma-glow">
                        ✨ {t('triviaTitle')} ✨
                      </h1>
                      <div className="absolute -top-2 md:-top-4 -right-2 md:-right-4 text-3xl md:text-6xl animate-bounce">🎯</div>
                      <div className="absolute -top-1 md:-top-2 -left-3 md:-left-6 text-2xl md:text-4xl animate-spin">🌟</div>
                    </div>
                    <p className="mobile-subtitle text-lg md:text-2xl text-cyan-200 font-semibold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                      {t('triviaSubtitle')}
                    </p>
                  </div>

              {/* Ses Kontrolü */}
              <button
                onClick={() => {
                  const newValue = !soundEnabled;
                  setSoundEnabled(newValue);
                  saveToLocalStorage('soundEnabled', newValue);
                }}
                className="sound-toggle"
                title={soundEnabled ? "Sesi Kapat" : "Sesi Aç"}
              >
                {soundEnabled ? "🔊" : "🔇"}
              </button>

                  <div className="bg-white/10 backdrop-blur-lg rounded-2xl md:rounded-3xl p-4 md:p-8 shadow-2xl border border-white/20">
                    <div className="mb-6 md:mb-10">
                      <h2 className="mobile-text text-xl md:text-3xl font-bold mb-4 md:mb-6 text-yellow-300 flex items-center gap-2 md:gap-3">
                        🎨 {t('categoriesTitle')}
                      </h2>
                      
                      {/* Rastgele Kategori Sistemi */}

                      
                      <div className="mobile-grid grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4">
                        {availableCategories.map(category => (
                          <button
                            key={category.name}
                            onClick={() => toggleCategory(category.name)}
                            className={`mobile-button group relative p-3 md:p-4 rounded-xl md:rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 border-2 ${
                              categories.includes(category.name)
                                ? `bg-gradient-to-r ${category.color} text-white border-white shadow-2xl scale-105`
                                : 'bg-white/5 text-white border-white/30 hover:border-white/60 hover:bg-white/10'
                            }`}
                          >
                            <div className="text-2xl md:text-3xl mb-1 md:mb-2">{category.emoji}</div>
                            <div className="text-xs md:text-sm">{category.name}</div>
                            {categories.includes(category.name) && (
                              <div className="absolute -top-1 md:-top-2 -right-1 md:-right-2 bg-green-400 text-green-900 rounded-full w-6 h-6 md:w-8 md:h-8 flex items-center justify-center text-sm md:text-xl font-black">
                                ✓
                              </div>
                            )}
                          </button>
                        ))}
                      </div>
                    </div>

                    <div className="grid md:grid-cols-2 gap-4 md:gap-8 mb-6 md:mb-10">
                      <div>
                        <h2 className="mobile-text text-xl md:text-3xl font-bold mb-4 md:mb-6 text-pink-300 flex items-center gap-2 md:gap-3">
                          ⚡ {t('difficultyTitle')}
                        </h2>
                        <div className="flex gap-2 md:gap-4">
                          {[
                            { key: 'easy', color: 'from-green-400 to-emerald-500', emoji: '😊' },
                            { key: 'medium', color: 'from-yellow-400 to-orange-500', emoji: '🤔' },
                            { key: 'hard', color: 'from-red-400 to-pink-500', emoji: '😤' }
                          ].map(diff => (
                            <button
                              key={diff.key}
                              onClick={() => {
                              setDifficulty(diff.key);
                              saveToLocalStorage('lastDifficulty', diff.key);
                            }}
                              className={`mobile-button flex-1 px-3 md:px-6 py-3 md:py-4 rounded-xl md:rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 border-2 ${
                                difficulty === diff.key
                                  ? `bg-gradient-to-r ${diff.color} text-white border-white shadow-2xl scale-105`
                                  : 'bg-white/5 text-white border-white/30 hover:border-white/60 hover:bg-white/10'
                              }`}
                            >
                              <div className="text-xl md:text-2xl mb-1">{diff.emoji}</div>
                              <div className="text-sm md:text-base">{t(diff.key)}</div>
                            </button>
                          ))}
                        </div>
                      </div>

                      <div>
                        <h2 className="mobile-text text-xl md:text-3xl font-bold mb-4 md:mb-6 text-purple-300 flex items-center gap-2 md:gap-3">
                          ⏰ Timer Ayarı
                        </h2>
                        <div className="flex gap-2 md:gap-4">
                          <button
                            onClick={() => {
                              const newValue = !timerEnabled;
                              setTimerEnabled(newValue);
                              saveToLocalStorage('timerEnabled', newValue);
                            }}
                            className={`mobile-button flex-1 px-3 md:px-6 py-3 md:py-4 rounded-xl md:rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 border-2 ${
                              timerEnabled
                                ? 'bg-gradient-to-r from-green-400 to-emerald-500 text-white border-white shadow-2xl scale-105'
                                : 'bg-white/5 text-white border-white/30 hover:border-white/60 hover:bg-white/10'
                            }`}
                          >
                            <div className="text-xl md:text-2xl mb-1">{timerEnabled ? '⏰' : '⏸️'}</div>
                            <div className="text-sm md:text-base">{timerEnabled ? 'Açık' : 'Kapalı'}</div>
                          </button>
                          {timerEnabled && (
                            <div className="text-xs md:text-sm text-white/70 flex items-center">
                              Kolay: 30s<br/>Orta: 20s<br/>Zor: 15s
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    <div className="grid md:grid-cols-2 gap-4 md:gap-8 mb-6 md:mb-10">
                      <div>
                        <h2 className="mobile-text text-xl md:text-3xl font-bold mb-4 md:mb-6 text-cyan-300 flex items-center gap-2 md:gap-3">
                          📊 {t('numQuestionsTitle')}
                        </h2>
                        <div className="grid grid-cols-2 gap-2 md:gap-4">
                          {[5, 10, 15, 20].map(num => (
                            <button
                              key={num}
                              onClick={() => {
                              setNumQuestions(num);
                              saveToLocalStorage('lastNumQuestions', num);
                            }}
                              className={`mobile-button px-3 md:px-6 py-3 md:py-4 rounded-xl md:rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 border-2 ${
                                numQuestions === num
                                  ? 'bg-gradient-to-r from-purple-400 to-pink-500 text-white border-white shadow-2xl scale-105'
                                  : 'bg-white/5 text-white border-white/30 hover:border-white/60 hover:bg-white/10'
                              }`}
                            >
                              <div className="text-xl md:text-2xl mb-1">🎲</div>
                              <div className="text-sm md:text-base">{num}</div>
                            </button>
                          ))}
                        </div>
                      </div>
                    </div>

                    {/* Tema Ayarları */}
                    <div className="mb-6 md:mb-8">
                      <h2 className="mobile-text text-xl md:text-2xl font-bold mb-4 text-indigo-300 flex items-center gap-2">
                        🎨 Tema Seçimi
                      </h2>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-3 mb-4">
                        {Object.entries(themes).map(([key, themeData]) => (
                          <button
                            key={key}
                            onClick={() => changeTheme(key)}
                            className={`mobile-button px-3 py-3 rounded-xl font-bold transition-all duration-300 transform hover:scale-105 border-2 ${
                              theme === key
                                ? `bg-gradient-to-r ${themeData.accent} text-white border-white shadow-2xl scale-105`
                                : 'bg-white/5 text-white border-white/30 hover:border-white/60 hover:bg-white/10'
                            }`}
                          >
                            <div className="text-lg mb-1">{themeData.emoji}</div>
                            <div className="text-xs">{themeData.name}</div>
                          </button>
                        ))}
                      </div>
                      
                      {/* Erişilebilirlik */}
                      <div className="flex gap-2">
                        <button
                          onClick={toggleHighContrast}
                          className={`mobile-button flex-1 px-3 py-2 rounded-xl font-bold transition-all duration-300 transform hover:scale-105 border-2 ${
                            highContrast
                              ? 'bg-gradient-to-r from-yellow-400 to-orange-500 text-black border-white shadow-2xl scale-105'
                              : 'bg-white/5 text-white border-white/30 hover:border-white/60 hover:bg-white/10'
                          }`}
                        >
                          <div className="text-sm">🔆 Yüksek Kontrast</div>
                        </button>
                      </div>
                    </div>

                    {/* Nickname ve Global Leaderboard */}
                    <div className="mb-6 md:mb-8">
                      <h2 className="mobile-text text-xl md:text-2xl font-bold mb-4 text-yellow-300 flex items-center gap-2">
                        👤 Oyuncu Bilgileri
                      </h2>
                      <div className="grid md:grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-medium text-white/80 mb-2">
                            Nickname (Global skor tablosu için)
                          </label>
                          <input
                            type="text"
                            value={nickname}
                            onChange={(e) => {
                              const newNickname = e.target.value;
                              setNickname(newNickname);
                              saveToLocalStorage('nickname', newNickname);
                            }}
                            placeholder="Nickname girin..."
                            maxLength={20}
                            className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-transparent"
                          />
                        </div>
                        <div className="flex items-end">
                          <button
                            onClick={() => {
                              setShowLeaderboard(true);
                              fetchGlobalScores();
                            }}
                            className="w-full px-4 py-3 rounded-xl font-bold transition-all duration-300 transform hover:scale-105 border-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white border-white shadow-xl"
                          >
                            <span className="flex items-center justify-center gap-2">
                              🏆 Global Skor Tablosu
                            </span>
                          </button>
                        </div>
                      </div>
                    </div>

                    {/* İstatistik Paneli */}
                    <div className="mb-6 md:mb-8">
                      <h2 className="mobile-text text-xl md:text-2xl font-bold mb-4 text-green-300 flex items-center gap-2">
                        📈 İstatistikler
                      </h2>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4">
                        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-3 md:p-4 border border-white/20 text-center">
                          <div className="text-xl md:text-2xl font-bold text-yellow-300">{totalGamesPlayed}</div>
                          <div className="text-xs md:text-sm text-white/70">Toplam Oyun</div>
                        </div>
                        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-3 md:p-4 border border-white/20 text-center">
                          <div className="text-xl md:text-2xl font-bold text-green-300">{loadFromLocalStorage('perfectGames', 0)}</div>
                          <div className="text-xs md:text-sm text-white/70">Mükemmel Skor</div>
                        </div>
                        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-3 md:p-4 border border-white/20 text-center">
                          <div className="text-xl md:text-2xl font-bold text-purple-300">{achievements.length}</div>
                          <div className="text-xs md:text-sm text-white/70">Başarı</div>
                        </div>
                        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-3 md:p-4 border border-white/20 text-center">
                          <div className="text-xl md:text-2xl font-bold text-blue-300">{loadFromLocalStorage('bestStreak', 0)}</div>
                          <div className="text-xs md:text-sm text-white/70">En İyi Seri</div>
                        </div>
                      </div>
                      
                      {/* Yüksek Skorlar */}
                      {highScores.length > 0 && (
                        <div className="mt-4">
                          <h3 className="text-lg font-bold mb-3 text-cyan-300 flex items-center gap-2">
                            🏆 En İyi Skorlar
                          </h3>
                          <div className="bg-white/5 backdrop-blur-lg rounded-xl p-3 border border-white/20 max-h-32 overflow-y-auto">
                            {highScores.slice(0, 5).map((score, index) => (
                              <div key={index} className="flex justify-between items-center py-1 border-b border-white/10 last:border-b-0">
                                <div className="flex items-center gap-2">
                                  <span className="text-yellow-400 font-bold text-sm">#{index + 1}</span>
                                  <span className="text-xs text-white/70 truncate max-w-24">
                                    {score.categories.slice(0, 1).join('')}
                                    {score.categories.length > 1 && '...'}
                                  </span>
                                </div>
                                <div className="text-sm font-bold text-white">
                                  {score.percentage}%
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>

                    <button
                      onClick={generateQuestions}
                      className={`w-full bg-gradient-to-r ${currentTheme.accent} hover:opacity-90 text-white font-black py-4 md:py-6 px-6 md:px-8 rounded-xl md:rounded-2xl text-lg md:text-2xl transition-all duration-300 shadow-2xl transform hover:scale-105 mb-6 md:mb-8`}
                    >
                      <span className="flex items-center justify-center gap-2 md:gap-3">
                        🚀 {t('startGameButton')} 🚀
                      </span>
                    </button>
                    
                    <div className="text-center text-sm md:text-lg text-white/80 border-t border-white/20 pt-4 md:pt-6">
                      <div className="flex items-center justify-center gap-2">
                        By{' '}
                        <a 
                          href="https://x.com/sercansolmaz" 
                          target="_blank" 
                          rel="noopener noreferrer"
                          className="text-cyan-300 hover:text-cyan-200 font-bold transition-colors duration-200 flex items-center gap-2 hover:scale-110 transform"
                        >
                          <svg className="w-4 h-4 md:w-5 md:h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                          </svg>
                          SercanSolmaz
                        </a>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Global Leaderboard Modal */}
                {showLeaderboard && (
                  <div className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div className={`bg-gradient-to-br ${currentTheme.background} rounded-2xl border border-gray-600/50 max-w-2xl w-full max-h-[80vh] overflow-hidden shadow-2xl`}>
                      <div className="p-6 border-b border-gray-600/50">
                        <div className="flex items-center justify-between">
                          <h3 className="text-2xl font-bold text-yellow-400 flex items-center gap-2">
                            🏆 Global Skor Tablosu
                          </h3>
                          <button 
                            onClick={() => setShowLeaderboard(false)}
                            className="text-gray-400 hover:text-white text-2xl font-bold p-2 hover:bg-gray-700/50 rounded-lg transition-colors"
                          >
                            ✕
                          </button>
                        </div>
                      </div>
                      
                      <div className="p-6 overflow-y-auto max-h-[60vh]">
                        {loadingScores ? (
                          <div className="text-center py-8">
                            <div className="animate-spin text-4xl mb-4">⚡</div>
                            <p className="text-gray-400">Skorlar yükleniyor...</p>
                          </div>
                        ) : globalScores.length === 0 ? (
                          <div className="text-center py-8">
                            <div className="text-4xl mb-4">🎯</div>
                            <p className="text-gray-400">Henüz skor yok. İlk skoru sen ekle!</p>
                          </div>
                        ) : (
                          <div className="space-y-3">
                            {globalScores.map((score, index) => (
                              <div 
                                key={index}
                                className={`p-4 rounded-xl border transition-all duration-200 ${
                                  score.nickname === nickname.trim() 
                                    ? 'bg-yellow-500/20 border-yellow-500/50 shadow-lg scale-105' 
                                    : 'bg-gray-800/50 border-gray-600/30 hover:bg-gray-700/50'
                                }`}
                              >
                                <div className="flex items-center justify-between">
                                  <div className="flex items-center gap-3">
                                    <div className={`text-2xl font-bold ${index === 0 ? 'text-yellow-400' : index === 1 ? 'text-gray-300' : index === 2 ? 'text-orange-400' : 'text-gray-500'}`}>
                                      #{index + 1}
                                    </div>
                                    <div>
                                      <div className="font-bold text-lg">{score.nickname}</div>
                                      <div className="text-sm text-gray-400">
                                        {score.score}/{score.totalQuestions} soru • {score.date}
                                      </div>
                                    </div>
                                  </div>
                                  <div className="text-right">
                                    <div className={`text-2xl font-bold ${score.percentage >= 90 ? 'text-green-400' : score.percentage >= 70 ? 'text-yellow-400' : 'text-red-400'}`}>
                                      %{score.percentage}
                                    </div>
                                    <div className="text-xs text-gray-500">
                                      {score.difficulty}
                                    </div>
                                  </div>
                                </div>
                                {score.categories && score.categories.length > 0 && (
                                  <div className="mt-2 flex flex-wrap gap-1">
                                    {score.categories.map((cat, i) => (
                                      <span key={i} className="px-2 py-1 bg-gray-700/50 text-xs rounded-full text-gray-300">
                                        {cat}
                                      </span>
                                    ))}
                                  </div>
                                )}
                              </div>
                            ))}
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                )}
              </div>
            );
          }

          if (gameState === 'loading') {
            return (
              <div className={`min-h-screen bg-gradient-to-br ${currentTheme.background} text-white flex items-center justify-center p-4 ${highContrast ? 'contrast-125 brightness-110' : ''}`}>
                <div className="text-center">
                  {/* Ses Kontrolü */}
                  <button
                    onClick={() => setSoundEnabled(!soundEnabled)}
                    className="sound-toggle"
                    title={soundEnabled ? "Sesi Kapat" : "Sesi Aç"}
                  >
                    {soundEnabled ? "🔊" : "🔇"}
                  </button>
                  <div className="relative mb-6 md:mb-8">
                    <div className="animate-spin w-16 h-16 md:w-24 md:h-24 border-6 md:border-8 border-cyan-400 border-t-transparent rounded-full mx-auto"></div>
                    <div className="absolute inset-0 animate-ping w-16 h-16 md:w-24 md:h-24 border-3 md:border-4 border-pink-400 border-t-transparent rounded-full mx-auto"></div>
                  </div>
                  <h2 className="mobile-text text-2xl md:text-4xl font-bold text-red-400 mb-3 md:mb-4 animate-pulse">
                    ⚡ {t('generatingQuestionsTitle')} ⚡
                  </h2>
                  <p className="mobile-text text-lg md:text-xl text-cyan-200">{t('generatingQuestionsSubtitle')}</p>
                  <div className="mt-6 md:mt-8 flex justify-center gap-2">
                    <div className="w-2 h-2 md:w-3 md:h-3 bg-pink-400 rounded-full animate-bounce"></div>
                    <div className="w-2 h-2 md:w-3 md:h-3 bg-yellow-400 rounded-full animate-bounce" style={{animationDelay: '0.1s'}}></div>
                    <div className="w-2 h-2 md:w-3 md:h-3 bg-cyan-400 rounded-full animate-bounce" style={{animationDelay: '0.2s'}}></div>
                  </div>
                </div>
              </div>
            );
          }

          if (gameState === 'playing') {
            const question = questions[currentQuestion];
            const categoryInfo = availableCategories.find(cat => cat.name === question.category) || 
                                { emoji: '❓', color: 'from-gray-400 to-gray-500' };
            
            return (
              <div className={`min-h-screen bg-gradient-to-br ${currentTheme.background} text-white p-4 ${highContrast ? 'contrast-125 brightness-110' : ''}`}>
                <div className="max-w-4xl mx-auto">
                  {/* Ses Kontrolü */}
                  <button
                    onClick={() => setSoundEnabled(!soundEnabled)}
                    className="sound-toggle"
                    title={soundEnabled ? "Sesi Kapat" : "Sesi Aç"}
                  >
                    {soundEnabled ? "🔊" : "🔇"}
                  </button>
                  <div className="mobile-flex flex flex-col md:flex-row justify-between items-center mb-6 md:mb-8 gap-4">
                    <div className="bg-white/10 backdrop-blur-lg rounded-xl md:rounded-2xl px-4 md:px-6 py-2 md:py-3 border border-white/20">
                      <div className="mobile-text text-cyan-300 font-bold text-lg md:text-xl flex items-center gap-2">
                        🎯 {t('questionOf')} {currentQuestion + 1} {t('of')} {questions.length}
                      </div>
                    </div>
                    
                    {/* Timer */}
                    {timerEnabled && (
                      <div className="timer-container">
                        <div className={`timer-circle ${timeLeft <= 5 ? 'timer-critical' : timeLeft <= 10 ? 'timer-warning' : ''}`}>
                          <div className="timer-text">{timeLeft}</div>
                        </div>
                      </div>
                    )}
                    
                    <div className="bg-white/10 backdrop-blur-lg rounded-xl md:rounded-2xl px-4 md:px-6 py-2 md:py-3 border border-white/20">
                      <div className={`mobile-text text-yellow-300 font-bold text-lg md:text-xl flex items-center gap-2 ${showAnswer ? 'score-animation' : ''}`}>
                        ⭐ {t('score')} {score}
                      </div>
                    </div>
                  </div>

                  <div className="bg-white/10 backdrop-blur-lg rounded-2xl md:rounded-3xl p-4 md:p-8 shadow-2xl border border-white/20">
                    <div className="mb-6 md:mb-8">
                      <div className={`inline-flex items-center gap-2 md:gap-3 px-4 md:px-6 py-2 md:py-3 bg-gradient-to-r ${categoryInfo.color} rounded-xl md:rounded-2xl text-white font-bold text-base md:text-lg mb-4 md:mb-6 shadow-lg`}>
                        <span className="text-xl md:text-2xl">{categoryInfo.emoji}</span>
                        <span className="mobile-text">{question.category}</span>
                      </div>
                      <h2 className="mobile-text text-xl md:text-3xl font-bold leading-relaxed text-white">
                        {question.question}
                      </h2>
                    </div>

                    <div className="space-y-3 md:space-y-4 mb-6 md:mb-8">
                      {question.options.map((option, index) => {
                        let buttonClass = 'w-full p-4 md:p-6 rounded-xl md:rounded-2xl font-bold text-left transition-all duration-300 transform hover:scale-102 border-2 ';
                        let showCheckmark = false;
                        
                        if (showAnswer) {
                          if (index === question.correctAnswer) {
                            buttonClass += 'bg-gradient-to-r from-green-400 to-emerald-500 text-white border-green-300 shadow-2xl scale-102';
                            showCheckmark = true;
                          } else if (index === selectedAnswer && index !== question.correctAnswer) {
                            buttonClass += 'bg-gradient-to-r from-red-400 to-pink-500 text-white border-red-300 shadow-xl';
                          } else {
                            buttonClass += 'bg-white/5 text-white/50 border-white/20';
                          }
                        } else {
                          if (selectedAnswer === index) {
                            buttonClass += 'bg-gradient-to-r from-purple-400 to-pink-500 text-white border-purple-300 shadow-2xl scale-102';
                          } else {
                            buttonClass += 'bg-white/5 text-white border-white/30 hover:border-white/60 hover:bg-white/10 hover:shadow-xl';
                          }
                        }
                        
                        return (
                          <button
                            key={index}
                            onClick={() => !showAnswer && selectAnswer(index)}
                            disabled={showAnswer}
                            className={`${buttonClass} ${getAnswerClass(index, index === question.correctAnswer, selectedAnswer === index)}`}
                          >
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-3 md:gap-4">
                                <span className="mobile-text text-lg md:text-2xl font-black bg-white/20 rounded-full w-8 h-8 md:w-10 md:h-10 flex items-center justify-center">
                                  {String.fromCharCode(65 + index)}
                                </span>
                                <span className="mobile-text text-base md:text-lg">{option}</span>
                              </div>
                              <div className="text-white text-2xl md:text-3xl w-6 h-6 md:w-8 md:h-8 flex items-center justify-center">
                                {showCheckmark && index === question.correctAnswer && '✅'}
                                {showAnswer && index === selectedAnswer && index !== question.correctAnswer && '❌'}
                              </div>
                            </div>
                          </button>
                        );
                      })}
                    </div>

                    <button
                      onClick={nextQuestion}
                      className="w-full bg-gradient-to-r from-orange-400 via-pink-400 to-purple-500 hover:from-orange-500 hover:via-pink-500 hover:to-purple-600 text-white font-black py-4 md:py-6 px-6 md:px-8 rounded-xl md:rounded-2xl text-lg md:text-2xl transition-all duration-300 shadow-2xl transform hover:scale-105"
                    >
                      <span className="flex items-center justify-center gap-2 md:gap-3">
                        {!showAnswer 
                          ? `🔍 ${t('checkAnswerButton')}`
                          : currentQuestion + 1 === questions.length 
                          ? `🏁 ${t('finishGameButton')}`
                          : `➡️ ${t('nextQuestionButton')}`}
                      </span>
                    </button>
                  </div>
                  
                  {/* Başarı Popup'ı */}
                  {showAchievement && (
                    <div className="achievement-popup">
                      <div className="achievement-emoji">{showAchievement.emoji}</div>
                      <div className="achievement-title">{showAchievement.name}</div>
                      <div className="achievement-description">{showAchievement.description}</div>
                    </div>
                  )}

                  {/* Global Leaderboard Modal */}
                  {showLeaderboard && (
                    <div className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                      <div className="bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 rounded-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden border border-white/20">
                        <div className="flex justify-between items-center p-6 border-b border-white/20">
                          <h2 className="text-2xl font-bold text-white flex items-center gap-2">
                            🏆 Global Skor Tablosu
                          </h2>
                          <button
                            onClick={() => setShowLeaderboard(false)}
                            className="text-white/60 hover:text-white text-2xl"
                          >
                            ✕
                          </button>
                        </div>
                        
                        <div className="p-6 overflow-y-auto max-h-96">
                          {loadingScores ? (
                            <div className="text-center py-8">
                              <div className="text-white/60">Skorlar yükleniyor...</div>
                            </div>
                          ) : globalScores.length === 0 ? (
                            <div className="text-center py-8">
                              <div className="text-white/60">Henüz skor yok. İlk skor sahibi olun!</div>
                            </div>
                          ) : (
                            <div className="space-y-2">
                              {globalScores.map((score, index) => (
                                <div key={index} className="flex items-center justify-between p-3 bg-white/10 rounded-xl border border-white/20">
                                  <div className="flex items-center gap-3">
                                    <div className={`text-lg font-bold ${
                                      index === 0 ? 'text-yellow-400' : 
                                      index === 1 ? 'text-gray-300' : 
                                      index === 2 ? 'text-amber-600' : 'text-white'
                                    }`}>
                                      #{index + 1}
                                    </div>
                                    <div>
                                      <div className="text-white font-bold">{score.nickname}</div>
                                      <div className="text-white/60 text-sm">
                                        {score.categories?.slice(0, 2).join(', ')} • {score.difficulty}
                                      </div>
                                    </div>
                                  </div>
                                  <div className="text-right">
                                    <div className="text-white font-bold">%{score.percentage}</div>
                                    <div className="text-white/60 text-sm">{score.score}/{score.totalQuestions}</div>
                                  </div>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                        
                        <div className="p-6 border-t border-white/20">
                          <button
                            onClick={() => fetchGlobalScores()}
                            disabled={loadingScores}
                            className="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-3 rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50"
                          >
                            🔄 Yenile
                          </button>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            );
          }

          if (gameState === 'results') {
            const percentage = Math.round((score / questions.length) * 100);
            return (
              <div className={`min-h-screen bg-gradient-to-br ${currentTheme.background} text-white p-4 ${highContrast ? 'contrast-125 brightness-110' : ''}`} onClick={resetGame}>
                <div className="max-w-4xl mx-auto text-center relative" onClick={(e) => e.stopPropagation()}>
                  <button
                    onClick={resetGame}
                    className="absolute right-3 top-3 text-white/80 hover:text-white text-2xl p-1 rounded-lg hover:bg-white/10"
                    aria-label="Kapat"
                  >
                    ✕
                  </button>
                  {/* Ses Kontrolü */}
                  <button
                    onClick={() => setSoundEnabled(!soundEnabled)}
                    className="sound-toggle"
                    title={soundEnabled ? "Sesi Kapat" : "Sesi Aç"}
                  >
                    {soundEnabled ? "🔊" : "🔇"}
                  </button>
                  
                  {/* Konfeti Efekti */}
                  {showConfetti && Array.from({ length: 50 }).map((_, i) => (
                    <div
                      key={i}
                      className="confetti"
                      style={{
                        left: `${Math.random() * 100}%`,
                        animationDelay: `${Math.random() * 3}s`,
                        background: `hsl(${Math.random() * 360}, 70%, 50%)`
                      }}
                    />
                  ))}
                  <div className="mb-6 md:mb-8">
                    <h1 className="mobile-title text-4xl md:text-6xl lg:text-7xl font-black mb-4 md:mb-6 bg-gradient-to-r from-yellow-400 via-pink-400 to-cyan-400 bg-clip-text text-transparent">
                      🏆 {t('resultsTitle')} 🏆
                    </h1>
                  </div>
                  
                  <div className="bg-white/10 backdrop-blur-lg rounded-2xl md:rounded-3xl p-4 md:p-8 shadow-2xl border border-white/20 mb-6 md:mb-8">
                    <div className="mobile-title text-4xl md:text-6xl lg:text-8xl font-black mb-4 md:mb-6 bg-gradient-to-r from-green-400 to-cyan-400 bg-clip-text text-transparent">
                      {score}/{questions.length}
                    </div>
                    <div className="mobile-text text-2xl md:text-4xl font-bold mb-6 md:mb-8 text-yellow-300">
                      {percentage}% {t('correct')}
                    </div>
                    
                    <div className="mobile-text text-xl md:text-3xl mb-8 md:mb-12 p-4 md:p-6 rounded-xl md:rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-400/30">
                      {percentage >= 80 ? t('excellentMessage') : 
                       percentage >= 60 ? t('goodJobMessage') : 
                       percentage >= 40 ? t('notBadMessage') : t('keepStudyingMessage')}
                    </div>

                    <div className="space-y-3 md:space-y-4 mb-6 md:mb-8 text-left max-h-64 md:max-h-96 overflow-y-auto">
                      {questions.map((question, index) => {
                        const userAnswer = answers[index];
                        const isCorrect = userAnswer && userAnswer.isCorrect;
                        const categoryInfo = availableCategories.find(cat => cat.name === question.category) || 
                                           { emoji: '❓', color: 'from-gray-400 to-gray-500' };
                        
                        return (
                          <div key={index} className={`p-4 md:p-6 rounded-xl md:rounded-2xl border-2 ${
                            isCorrect 
                              ? 'border-green-400 bg-gradient-to-r from-green-900/30 to-emerald-900/30' 
                              : 'border-red-400 bg-gradient-to-r from-red-900/30 to-pink-900/30'
                          }`}>
                            <div className="flex items-center gap-2 md:gap-3 mb-2 md:mb-3">
                              <span className="text-xl md:text-2xl">{categoryInfo.emoji}</span>
                              <span className="mobile-text font-bold text-base md:text-lg">{question.question}</span>
                            </div>
                            <div className="mobile-text text-base md:text-lg">
                              <div className={`mb-1 md:mb-2 ${isCorrect ? 'text-green-300' : 'text-red-300'}`}>
                                {isCorrect ? '✅' : '❌'} {t('yourAnswer')} {question.options[userAnswer.selectedAnswer]}
                              </div>
                              {!isCorrect && (
                                <div className="text-green-300">
                                  ✅ {t('correctAnswer')} {question.options[question.correctAnswer]}
                                </div>
                              )}
                            </div>
                          </div>
                        );
                      })}
                    </div>

                    <div className="grid gap-4 mb-6 md:mb-8">
                    <button
                      onClick={resetGame}
                        className="w-full bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-500 hover:from-cyan-500 hover:via-blue-500 hover:to-purple-600 text-white font-black py-4 md:py-6 px-6 md:px-8 rounded-xl md:rounded-2xl text-lg md:text-2xl transition-all duration-300 shadow-2xl transform hover:scale-105"
                    >
                      <span className="flex items-center justify-center gap-2 md:gap-3">
                        🔄 {t('playAgainButton')} 🔄
                      </span>
                    </button>
                      
                      {nickname.trim() && (
                        <button
                          onClick={() => {
                            const scoreData = {
                              score: score,
                              totalQuestions: questions.length,
                              difficulty: difficulty,
                              categories: categories
                            };
                            submitScore(scoreData);
                          }}
                          className="w-full bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white font-black py-4 md:py-6 px-6 md:px-8 rounded-xl md:rounded-2xl text-lg md:text-2xl transition-all duration-300 shadow-2xl transform hover:scale-105"
                        >
                          <span className="flex items-center justify-center gap-2 md:gap-3">
                            🏆 Global Skor Tablosuna Gönder 🏆
                          </span>
                        </button>
                       )}

                      <div className="grid gap-2 md:gap-3 mt-2">
                        <button
                          onClick={shareScore}
                          className="w-full bg-gradient-to-r from-green-400 to-emerald-500 hover:from-green-500 hover:to-emerald-600 text-white font-black py-3 md:py-4 px-6 rounded-xl text-lg md:text-xl transition-all duration-300 shadow-2xl transform hover:scale-105"
                        >
                          <span className="flex items-center justify-center gap-2 md:gap-3">📣 Skorumu Paylaş (#prizmagame)</span>
                        </button>
                      </div>
                    </div>
                    
                    <div className="text-center text-sm md:text-lg text-white/80 border-t border-white/20 pt-4 md:pt-6">
                      <div className="flex items-center justify-center gap-2">
                        By{' '}
                        <a 
                          href="https://x.com/sercansolmaz" 
                          target="_blank" 
                          rel="noopener noreferrer"
                          className="text-cyan-300 hover:text-cyan-200 font-bold transition-colors duration-200 flex items-center gap-2 hover:scale-110 transform"
                        >
                          <svg className="w-4 h-4 md:w-5 md:h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                          </svg>
                          SercanSolmaz
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* Başarı Popup'ı */}
                {showAchievement && (
                  <div className="achievement-popup">
                    <div className="achievement-emoji">{showAchievement.emoji}</div>
                    <div className="achievement-title">{showAchievement.name}</div>
                    <div className="achievement-description">{showAchievement.description}</div>
                  </div>
                )}

                {/* Global Leaderboard Modal */}
                {showLeaderboard && (
                  <div className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div className={`bg-gradient-to-br ${currentTheme.background} rounded-2xl border border-gray-600/50 max-w-2xl w-full max-h-[80vh] overflow-hidden shadow-2xl`}>
                      <div className="p-6 border-b border-gray-600/50">
                        <div className="flex items-center justify-between">
                          <h3 className="text-2xl font-bold text-yellow-400 flex items-center gap-2">
                            🏆 Global Skor Tablosu
                          </h3>
                          <button 
                            onClick={() => setShowLeaderboard(false)}
                            className="text-gray-400 hover:text-white text-2xl font-bold p-2 hover:bg-gray-700/50 rounded-lg transition-colors"
                          >
                            ✕
                          </button>
                        </div>
                      </div>
                      
                      <div className="p-6 overflow-y-auto max-h-[60vh]">
                        {loadingScores ? (
                          <div className="text-center py-8">
                            <div className="animate-spin text-4xl mb-4">⚡</div>
                            <p className="text-gray-400">Skorlar yükleniyor...</p>
                          </div>
                        ) : globalScores.length === 0 ? (
                          <div className="text-center py-8">
                            <div className="text-4xl mb-4">🎯</div>
                            <p className="text-gray-400">Henüz skor yok. İlk skoru sen ekle!</p>
                          </div>
                        ) : (
                          <div className="space-y-3">
                            {globalScores.map((score, index) => (
                              <div 
                                key={index}
                                className={`p-4 rounded-xl border transition-all duration-200 ${
                                  score.nickname === nickname.trim() 
                                    ? 'bg-yellow-500/20 border-yellow-500/50 shadow-lg scale-105' 
                                    : 'bg-gray-800/50 border-gray-600/30 hover:bg-gray-700/50'
                                }`}
                              >
                                <div className="flex items-center justify-between">
                                  <div className="flex items-center gap-3">
                                    <div className={`text-2xl font-bold ${index === 0 ? 'text-yellow-400' : index === 1 ? 'text-gray-300' : index === 2 ? 'text-orange-400' : 'text-gray-500'}`}>
                                      #{index + 1}
                                    </div>
                                    <div>
                                      <div className="font-bold text-lg">{score.nickname}</div>
                                      <div className="text-sm text-gray-400">
                                        {score.score}/{score.totalQuestions} soru • {score.date}
                                      </div>
                                    </div>
                                  </div>
                                  <div className="text-right">
                                    <div className={`text-2xl font-bold ${score.percentage >= 90 ? 'text-green-400' : score.percentage >= 70 ? 'text-yellow-400' : 'text-red-400'}`}>
                                      %{score.percentage}
                                    </div>
                                    <div className="text-xs text-gray-500">
                                      {score.difficulty}
                                    </div>
                                  </div>
                                </div>
                                {score.categories && score.categories.length > 0 && (
                                  <div className="mt-2 flex flex-wrap gap-1">
                                    {score.categories.map((cat, i) => (
                                      <span key={i} className="px-2 py-1 bg-gray-700/50 text-xs rounded-full text-gray-300">
                                        {cat}
                                      </span>
                                    ))}
                                  </div>
                                )}
                              </div>
                            ))}
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                )}
              </div>
            );
          }



        };

        ReactDOM.render(<TriviaGame />, document.getElementById('root'));
    </script>
</body>
</html>